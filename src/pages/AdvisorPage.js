import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { useAuth } from '@/hooks/useAuth';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Button } from '@/components/ui/button';
import { Building, Users, FileText, LogOut, Store, TrendingUp } from 'lucide-react';
import { Navigate, useNavigate } from 'react-router-dom';
import AdvisorManagement from '@/components/AdvisorManagement';
import { FranchiseesManagement } from '@/components/FranchiseesManagement';
import { AdvisorReports } from '@/components/AdvisorReports';
import { BaseRestaurantsTable } from '@/components/BaseRestaurantsTable';
import { useBaseRestaurants } from '@/hooks/useBaseRestaurants';
const AdvisorPage = () => {
    const { user, signOut, loading } = useAuth();
    const navigate = useNavigate();
    const [activeTab, setActiveTab] = useState('advisors');
    const { restaurants, loading: restaurantsLoading, refetch: refetchRestaurants } = useBaseRestaurants();
    if (loading) {
        return (_jsx("div", { className: "min-h-screen bg-gray-50 flex items-center justify-center", children: _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "w-12 h-12 bg-red-600 rounded-xl animate-spin mx-auto mb-4" }), _jsx("p", { className: "text-gray-600", children: "Cargando..." })] }) }));
    }
    if (!user || !['asesor', 'admin', 'superadmin'].includes(user.role)) {
        return _jsx(Navigate, { to: "/auth", replace: true });
    }
    const handleSignOut = async () => {
        await signOut();
        navigate('/auth');
    };
    const getRoleDisplay = (role) => {
        switch (role) {
            case 'superadmin': return 'Super Admin';
            case 'admin': return 'Admin';
            case 'asesor': return 'Asesor';
            default: return 'Asesor';
        }
    };
    return (_jsxs("div", { className: "min-h-screen bg-gray-50", children: [_jsx("header", { className: "bg-white shadow-sm border-b border-gray-200", children: _jsx("div", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8", children: _jsxs("div", { className: "flex justify-between items-center h-16", children: [_jsxs("div", { className: "flex items-center space-x-4", children: [_jsx("div", { className: "w-10 h-10 bg-red-600 rounded-xl flex items-center justify-center", children: _jsx(Store, { className: "text-white w-5 h-5" }) }), _jsxs("div", { children: [_jsx("h1", { className: "text-xl font-bold text-gray-900", children: "Panel de Asesor" }), _jsxs("p", { className: "text-sm text-gray-500", children: [user.full_name, " \u2022 ", getRoleDisplay(user.role)] })] })] }), _jsxs(Button, { onClick: handleSignOut, variant: "outline", className: "border-gray-300 text-gray-700 hover:bg-gray-50", children: [_jsx(LogOut, { className: "w-4 h-4 mr-2" }), "Cerrar Sesi\u00F3n"] })] }) }) }), _jsxs("div", { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8", children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-6 mb-8", children: [_jsx(Card, { className: "bg-white border-0 shadow-lg", children: _jsx(CardContent, { className: "p-6", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-gray-500", children: "Total Asesores" }), _jsx("p", { className: "text-3xl font-bold text-gray-900", children: "12" })] }), _jsx("div", { className: "w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center", children: _jsx(Users, { className: "w-6 h-6 text-blue-600" }) })] }) }) }), _jsx(Card, { className: "bg-white border-0 shadow-lg", children: _jsx(CardContent, { className: "p-6", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-gray-500", children: "Franquiciados" }), _jsx("p", { className: "text-3xl font-bold text-gray-900", children: "45" })] }), _jsx("div", { className: "w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center", children: _jsx(Building, { className: "w-6 h-6 text-green-600" }) })] }) }) }), _jsx(Card, { className: "bg-white border-0 shadow-lg", children: _jsx(CardContent, { className: "p-6", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-gray-500", children: "Restaurantes" }), _jsx("p", { className: "text-3xl font-bold text-gray-900", children: restaurants.length })] }), _jsx("div", { className: "w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center", children: _jsx(Store, { className: "w-6 h-6 text-purple-600" }) })] }) }) }), _jsx(Card, { className: "bg-white border-0 shadow-lg", children: _jsx(CardContent, { className: "p-6", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-gray-500", children: "Rendimiento" }), _jsx("p", { className: "text-3xl font-bold text-green-600", children: "+8.2%" })] }), _jsx("div", { className: "w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center", children: _jsx(TrendingUp, { className: "w-6 h-6 text-green-600" }) })] }) }) })] }), _jsxs(Tabs, { value: activeTab, onValueChange: setActiveTab, className: "space-y-6", children: [_jsxs(TabsList, { className: "grid w-full grid-cols-4 bg-white border border-gray-200 p-1 rounded-xl", children: [_jsxs(TabsTrigger, { value: "advisors", className: "flex items-center gap-2 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 rounded-lg", children: [_jsx(Users, { className: "w-4 h-4" }), "Asesores"] }), _jsxs(TabsTrigger, { value: "franchisees", className: "flex items-center gap-2 data-[state=active]:bg-green-50 data-[state=active]:text-green-600 rounded-lg", children: [_jsx(Building, { className: "w-4 h-4" }), "Franquiciados"] }), _jsxs(TabsTrigger, { value: "restaurants", className: "flex items-center gap-2 data-[state=active]:bg-purple-50 data-[state=active]:text-purple-600 rounded-lg", children: [_jsx(Store, { className: "w-4 h-4" }), "Restaurantes"] }), _jsxs(TabsTrigger, { value: "reports", className: "flex items-center gap-2 data-[state=active]:bg-orange-50 data-[state=active]:text-orange-600 rounded-lg", children: [_jsx(FileText, { className: "w-4 h-4" }), "Reportes"] })] }), _jsx(TabsContent, { value: "advisors", children: _jsxs(Card, { className: "border-0 shadow-lg bg-white", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-xl text-gray-900", children: "Gesti\u00F3n de Asesores y Administradores" }) }), _jsx(CardContent, { children: _jsx(AdvisorManagement, {}) })] }) }), _jsx(TabsContent, { value: "franchisees", children: _jsxs(Card, { className: "border-0 shadow-lg bg-white", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-xl text-gray-900", children: "Gesti\u00F3n de Franquiciados" }) }), _jsx(CardContent, { children: _jsx(FranchiseesManagement, {}) })] }) }), _jsx(TabsContent, { value: "restaurants", children: _jsxs(Card, { className: "border-0 shadow-lg bg-white", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-xl text-gray-900", children: "Gesti\u00F3n de Restaurantes Base" }) }), _jsx(CardContent, { children: restaurantsLoading ? (_jsxs("div", { className: "text-center py-12", children: [_jsx("div", { className: "w-8 h-8 bg-red-600 rounded-xl animate-spin mx-auto mb-4" }), _jsx("p", { className: "text-gray-600", children: "Cargando restaurantes..." })] })) : (_jsx(BaseRestaurantsTable, { restaurants: restaurants, onRefresh: refetchRestaurants })) })] }) }), _jsx(TabsContent, { value: "reports", children: _jsxs(Card, { className: "border-0 shadow-lg bg-white", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-xl text-gray-900", children: "Reportes y An\u00E1lisis" }) }), _jsx(CardContent, { children: _jsx(AdvisorReports, {}) })] }) })] })] })] }));
};
export default AdvisorPage;
