import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Button } from '@/components/ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Download, TrendingUp, DollarSign, BarChart3 } from 'lucide-react';
import { useAuth } from '@/hooks/useAuth';
import { useFranchiseeRestaurants } from '@/hooks/useFranchiseeRestaurants';
import { FinancialMetrics } from './FinancialMetrics';
import { PerformanceCharts } from './PerformanceCharts';
import { RestaurantComparison } from './RestaurantComparison';
import { ProfitabilityAnalysis } from './ProfitabilityAnalysis';
export const AnalysisDashboard = () => {
    const { franchisee } = useAuth();
    const { restaurants } = useFranchiseeRestaurants();
    const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
    const [selectedRestaurant, setSelectedRestaurant] = useState('all');
    // Generar aÃ±os disponibles
    const currentYear = new Date().getFullYear();
    const availableYears = Array.from({ length: 5 }, (_, i) => currentYear - 4 + i);
    if (!franchisee) {
        return (_jsx("div", { className: "flex items-center justify-center h-64", children: _jsx("p", { className: "text-gray-600", children: "Cargando datos del franquiciado..." }) }));
    }
    return (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex justify-between items-start", children: [_jsxs("div", { children: [_jsx("h1", { className: "text-3xl font-bold text-gray-900", children: "An\u00E1lisis Financiero" }), _jsxs("p", { className: "text-gray-600", children: ["An\u00E1lisis integral de rendimiento - ", franchisee.franchisee_name] })] }), _jsxs("div", { className: "flex gap-3", children: [_jsxs(Select, { value: selectedYear.toString(), onValueChange: (value) => setSelectedYear(parseInt(value)), children: [_jsx(SelectTrigger, { className: "w-32", children: _jsx(SelectValue, {}) }), _jsx(SelectContent, { children: availableYears.map(year => (_jsx(SelectItem, { value: year.toString(), children: year }, year))) })] }), _jsxs(Select, { value: selectedRestaurant, onValueChange: setSelectedRestaurant, children: [_jsx(SelectTrigger, { className: "w-48", children: _jsx(SelectValue, {}) }), _jsxs(SelectContent, { children: [_jsx(SelectItem, { value: "all", children: "Todos los Restaurantes" }), restaurants.map(restaurant => (_jsx(SelectItem, { value: restaurant.id, children: restaurant.base_restaurant?.restaurant_name || `Restaurante ${restaurant.base_restaurant?.site_number}` }, restaurant.id)))] })] }), _jsxs(Button, { variant: "outline", children: [_jsx(Download, { className: "w-4 h-4 mr-2" }), "Exportar"] })] })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-4", children: [_jsxs(Card, { children: [_jsxs(CardHeader, { className: "flex flex-row items-center justify-between space-y-0 pb-2", children: [_jsx(CardTitle, { className: "text-sm font-medium", children: "Ingresos Totales" }), _jsx(DollarSign, { className: "h-4 w-4 text-green-600" })] }), _jsxs(CardContent, { children: [_jsx("div", { className: "text-2xl font-bold", children: "\u20AC1,234,567" }), _jsxs("p", { className: "text-xs text-muted-foreground", children: [_jsx("span", { className: "text-green-600", children: "+12.3%" }), " vs a\u00F1o anterior"] })] })] }), _jsxs(Card, { children: [_jsxs(CardHeader, { className: "flex flex-row items-center justify-between space-y-0 pb-2", children: [_jsx(CardTitle, { className: "text-sm font-medium", children: "Margen Operativo" }), _jsx(TrendingUp, { className: "h-4 w-4 text-blue-600" })] }), _jsxs(CardContent, { children: [_jsx("div", { className: "text-2xl font-bold", children: "18.5%" }), _jsxs("p", { className: "text-xs text-muted-foreground", children: [_jsx("span", { className: "text-green-600", children: "+2.1%" }), " vs a\u00F1o anterior"] })] })] }), _jsxs(Card, { children: [_jsxs(CardHeader, { className: "flex flex-row items-center justify-between space-y-0 pb-2", children: [_jsx(CardTitle, { className: "text-sm font-medium", children: "ROI Promedio" }), _jsx(BarChart3, { className: "h-4 w-4 text-purple-600" })] }), _jsxs(CardContent, { children: [_jsx("div", { className: "text-2xl font-bold", children: "24.8%" }), _jsxs("p", { className: "text-xs text-muted-foreground", children: [_jsx("span", { className: "text-red-600", children: "-1.2%" }), " vs a\u00F1o anterior"] })] })] }), _jsxs(Card, { children: [_jsxs(CardHeader, { className: "flex flex-row items-center justify-between space-y-0 pb-2", children: [_jsx(CardTitle, { className: "text-sm font-medium", children: "Restaurantes Activos" }), _jsx(TrendingUp, { className: "h-4 w-4 text-orange-600" })] }), _jsxs(CardContent, { children: [_jsx("div", { className: "text-2xl font-bold", children: restaurants.length }), _jsx("p", { className: "text-xs text-muted-foreground", children: "En operaci\u00F3n" })] })] })] }), _jsxs(Tabs, { defaultValue: "metrics", className: "w-full", children: [_jsxs(TabsList, { className: "grid w-full grid-cols-4", children: [_jsx(TabsTrigger, { value: "metrics", children: "M\u00E9tricas Financieras" }), _jsx(TabsTrigger, { value: "performance", children: "Rendimiento" }), _jsx(TabsTrigger, { value: "comparison", children: "Comparaci\u00F3n" }), _jsx(TabsTrigger, { value: "profitability", children: "Rentabilidad" })] }), _jsx(TabsContent, { value: "metrics", className: "space-y-6", children: _jsx(FinancialMetrics, { selectedYear: selectedYear, selectedRestaurant: selectedRestaurant, restaurants: restaurants }) }), _jsx(TabsContent, { value: "performance", className: "space-y-6", children: _jsx(PerformanceCharts, { selectedYear: selectedYear, selectedRestaurant: selectedRestaurant, restaurants: restaurants }) }), _jsx(TabsContent, { value: "comparison", className: "space-y-6", children: _jsx(RestaurantComparison, { selectedYear: selectedYear, restaurants: restaurants }) }), _jsx(TabsContent, { value: "profitability", className: "space-y-6", children: _jsx(ProfitabilityAnalysis, { selectedYear: selectedYear, selectedRestaurant: selectedRestaurant, restaurants: restaurants }) })] })] }));
};
